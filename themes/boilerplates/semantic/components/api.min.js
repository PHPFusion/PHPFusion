/*!
 * # Semantic UI 2.4.2 - API
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(c,b,a,d){var b=(typeof b!="undefined"&&b.Math==Math)?b:(typeof self!="undefined"&&self.Math==Math)?self:Function("return this")();c.api=c.fn.api=function(m){var k=c.isFunction(this)?c(b):c(this),h=k.selector||"",f=new Date().getTime(),j=[],i=arguments[0],e=(typeof i=="string"),l=[].slice.call(arguments,1),g;k.each(function(){var E=(c.isPlainObject(m))?c.extend(true,{},c.fn.api.settings,m):c.extend({},c.fn.api.settings),x=E.namespace,w=E.metadata,C=E.selector,B=E.error,q=E.className,A="."+x,y="module-"+x,t=c(this),u=t.closest(C.form),z=(E.stateContext)?c(E.stateContext):t,v,r,s,G,D,o=this,p=z[0],F=t.data(y),n;n={initialize:function(){if(!e){n.bind.events()}n.instantiate()},instantiate:function(){n.verbose("Storing instance of module",n);F=n;t.data(y,F)},destroy:function(){n.verbose("Destroying previous module for",o);t.removeData(y).off(A)},bind:{events:function(){var H=n.get.event();if(H){n.verbose("Attaching API events to element",H);t.on(H+A,n.event.trigger)}else{if(E.on=="now"){n.debug("Querying API endpoint immediately");n.query()}}}},decode:{json:function(H){if(H!==d&&typeof H=="string"){try{H=JSON.parse(H)}catch(I){}}return H}},read:{cachedResponse:function(I){var H;if(b.Storage===d){n.error(B.noStorage);return}H=sessionStorage.getItem(I);n.debug("Using cached response",I,H);H=n.decode.json(H);return H}},write:{cachedResponse:function(I,H){if(H&&H===""){n.debug("Response empty, not caching",H);return}if(b.Storage===d){n.error(B.noStorage);return}if(c.isPlainObject(H)){H=JSON.stringify(H)}sessionStorage.setItem(I,H);n.verbose("Storing cached response for url",I,H)}},query:function(){if(n.is.disabled()){n.debug("Element is disabled API request aborted");return}if(n.is.loading()){if(E.interruptRequests){n.debug("Interrupting previous request");n.abort()}else{n.debug("Cancelling request, previous request is still pending");return}}if(E.defaultData){c.extend(true,E.urlData,n.get.defaultData())}if(E.serializeForm){E.data=n.add.formData(E.data)}r=n.get.settings();if(r===false){n.cancelled=true;n.error(B.beforeSend);return}else{n.cancelled=false}s=n.get.templatedURL();if(!s&&!n.is.mocked()){n.error(B.missingURL);return}s=n.add.urlData(s);if(!s&&!n.is.mocked()){return}r.url=E.base+s;v=c.extend(true,{},E,{type:E.method||E.type,data:G,url:E.base+s,beforeSend:E.beforeXHR,success:function(){},failure:function(){},complete:function(){}});n.debug("Querying URL",v.url);n.verbose("Using AJAX settings",v);if(E.cache==="local"&&n.read.cachedResponse(s)){n.debug("Response returned from local cache");n.request=n.create.request();n.request.resolveWith(p,[n.read.cachedResponse(s)]);return}if(!E.throttle){n.debug("Sending request",G,v.method);n.send.request()}else{if(!E.throttleFirstRequest&&!n.timer){n.debug("Sending request",G,v.method);n.send.request();n.timer=setTimeout(function(){},E.throttle)}else{n.debug("Throttling request",E.throttle);clearTimeout(n.timer);n.timer=setTimeout(function(){if(n.timer){delete n.timer}n.debug("Sending throttled request",G,v.method);n.send.request()},E.throttle)}}},should:{removeError:function(){return(E.hideError===true||(E.hideError==="auto"&&!n.is.form()))}},is:{disabled:function(){return(t.filter(C.disabled).length>0)},expectingJSON:function(){return E.dataType==="json"||E.dataType==="jsonp"},form:function(){return t.is("form")||z.is("form")},mocked:function(){return(E.mockResponse||E.mockResponseAsync||E.response||E.responseAsync)},input:function(){return t.is("input")},loading:function(){return(n.request)?(n.request.state()=="pending"):false},abortedRequest:function(H){if(H&&H.readyState!==d&&H.readyState===0){n.verbose("XHR request determined to be aborted");return true}else{n.verbose("XHR request was not aborted");return false}},validResponse:function(H){if((!n.is.expectingJSON())||!c.isFunction(E.successTest)){n.verbose("Response is not JSON, skipping validation",E.successTest,H);return true}n.debug("Checking JSON returned success",E.successTest,H);if(E.successTest(H)){n.debug("Response passed success test",H);return true}else{n.debug("Response failed success test",H);return false}}},was:{cancelled:function(){return(n.cancelled||false)},succesful:function(){return(n.request&&n.request.state()=="resolved")},failure:function(){return(n.request&&n.request.state()=="rejected")},complete:function(){return(n.request&&(n.request.state()=="resolved"||n.request.state()=="rejected"))}},add:{urlData:function(I,H){var J,K;if(I){J=I.match(E.regExp.required);K=I.match(E.regExp.optional);H=H||E.urlData;if(J){n.debug("Looking for required URL variables",J);c.each(J,function(M,N){var L=(N.indexOf("$")!==-1)?N.substr(2,N.length-3):N.substr(1,N.length-2),O=(c.isPlainObject(H)&&H[L]!==d)?H[L]:(t.data(L)!==d)?t.data(L):(z.data(L)!==d)?z.data(L):H[L];if(O===d){n.error(B.requiredParameter,L,I);I=false;return false}else{n.verbose("Found required variable",L,O);O=(E.encodeParameters)?n.get.urlEncodedValue(O):O;I=I.replace(N,O)}})}if(K){n.debug("Looking for optional URL variables",J);c.each(K,function(M,N){var L=(N.indexOf("$")!==-1)?N.substr(3,N.length-4):N.substr(2,N.length-3),O=(c.isPlainObject(H)&&H[L]!==d)?H[L]:(t.data(L)!==d)?t.data(L):(z.data(L)!==d)?z.data(L):H[L];if(O!==d){n.verbose("Optional variable Found",L,O);I=I.replace(N,O)}else{n.verbose("Optional variable not found",L);if(I.indexOf("/"+N)!==-1){I=I.replace("/"+N,"")}else{I=I.replace(N,"")}}})}}return I},formData:function(J){var H=(c.fn.serializeObject!==d),K=(H)?u.serializeObject():u.serialize(),I;J=J||E.data;I=c.isPlainObject(J);if(I){if(H){n.debug("Extending existing data with form data",J,K);J=c.extend(true,{},J,K)}else{n.error(B.missingSerialize);n.debug("Cant extend data. Replacing data with form data",J,K);J=K}}else{n.debug("Adding form data",K);J=K}return J}},send:{request:function(){n.set.loading();n.request=n.create.request();if(n.is.mocked()){n.mockedXHR=n.create.mockedXHR()}else{n.xhr=n.create.xhr()}E.onRequest.call(p,n.request,n.xhr)}},event:{trigger:function(H){n.query();if(H.type=="submit"||H.type=="click"){H.preventDefault()}},xhr:{always:function(){},done:function(I,N,L){var J=this,H=(new Date().getTime()-D),M=(E.loadingDuration-H),K=(c.isFunction(E.onResponse))?n.is.expectingJSON()?E.onResponse.call(J,c.extend(true,{},I)):E.onResponse.call(J,I):false;M=(M>0)?M:0;if(K){n.debug("Modified API response in onResponse callback",E.onResponse,K,I);I=K}if(M>0){n.debug("Response completed early delaying state change by",M)}setTimeout(function(){if(n.is.validResponse(I)){n.request.resolveWith(J,[I,L])}else{n.request.rejectWith(J,[L,"invalid"])}},M)},fail:function(L,H,J){var K=this,I=(new Date().getTime()-D),M=(E.loadingDuration-I);M=(M>0)?M:0;if(M>0){n.debug("Response completed early delaying state change by",M)}setTimeout(function(){if(n.is.abortedRequest(L)){n.request.rejectWith(K,[L,"aborted",J])}else{n.request.rejectWith(K,[L,"error",H,J])}},M)}},request:{done:function(H,I){n.debug("Successful API Response",H);if(E.cache==="local"&&s){n.write.cachedResponse(s,H);n.debug("Saving server response locally",n.cache)}E.onSuccess.call(p,H,t,I)},complete:function(K,J){var I,H;if(n.was.succesful()){H=K;I=J}else{I=K;H=n.get.responseFromXHR(I)}n.remove.loading();E.onComplete.call(p,H,t,I)},fail:function(L,H,K){var I=n.get.responseFromXHR(L),J=n.get.errorFromRequest(I,H,K);if(H=="aborted"){n.debug("XHR Aborted (Most likely caused by page navigation or CORS Policy)",H,K);E.onAbort.call(p,H,t,L);return true}else{if(H=="invalid"){n.debug("JSON did not pass success test. A server-side error has most likely occurred",I)}else{if(H=="error"){if(L!==d){n.debug("XHR produced a server error",H,K);if(L.status!=200&&K!==d&&K!==""){n.error(B.statusMessage+K,v.url)}E.onError.call(p,J,t,L)}}}}if(E.errorDuration&&H!=="aborted"){n.debug("Adding error state");n.set.error();if(n.should.removeError()){setTimeout(n.remove.error,E.errorDuration)}}n.debug("API Request failed",J,L);E.onFailure.call(p,I,t,L)}}},create:{request:function(){return c.Deferred().always(n.event.request.complete).done(n.event.request.done).fail(n.event.request.fail)},mockedXHR:function(){var O=false,I=false,M=false,L=E.mockResponse||E.response,K=E.mockResponseAsync||E.responseAsync,H,J,N;N=c.Deferred().always(n.event.xhr.complete).done(n.event.xhr.done).fail(n.event.xhr.fail);if(L){if(c.isFunction(L)){n.debug("Using specified synchronous callback",L);J=L.call(p,r)}else{n.debug("Using settings specified response",L);J=L}N.resolveWith(p,[J,O,{responseText:J}])}else{if(c.isFunction(K)){H=function(P){n.debug("Async callback returned response",P);if(P){N.resolveWith(p,[P,O,{responseText:P}])}else{N.rejectWith(p,[{responseText:P},I,M])}};n.debug("Using specified async response callback",K);K.call(p,r,H)}}return N},xhr:function(){var H;H=c.ajax(v).always(n.event.xhr.always).done(n.event.xhr.done).fail(n.event.xhr.fail);n.verbose("Created server request",H,v);return H}},set:{error:function(){n.verbose("Adding error state to element",z);z.addClass(q.error)},loading:function(){n.verbose("Adding loading state to element",z);z.addClass(q.loading);D=new Date().getTime()}},remove:{error:function(){n.verbose("Removing error state from element",z);z.removeClass(q.error)},loading:function(){n.verbose("Removing loading state from element",z);z.removeClass(q.loading)}},get:{responseFromXHR:function(H){return c.isPlainObject(H)?(n.is.expectingJSON())?n.decode.json(H.responseText):H.responseText:false},errorFromRequest:function(I,H,J){return(c.isPlainObject(I)&&I.error!==d)?I.error:(E.error[H]!==d)?E.error[H]:J},request:function(){return n.request||false},xhr:function(){return n.xhr||false},settings:function(){var H;H=E.beforeSend.call(p,E);if(H){if(H.success!==d){n.debug("Legacy success callback detected",H);n.error(B.legacyParameters,H.success);H.onSuccess=H.success}if(H.failure!==d){n.debug("Legacy failure callback detected",H);n.error(B.legacyParameters,H.failure);H.onFailure=H.failure}if(H.complete!==d){n.debug("Legacy complete callback detected",H);n.error(B.legacyParameters,H.complete);H.onComplete=H.complete}}if(H===d){n.error(B.noReturnedValue)}if(H===false){return H}return(H!==d)?c.extend(true,{},H):c.extend(true,{},E)},urlEncodedValue:function(K){var I=b.decodeURIComponent(K),H=b.encodeURIComponent(K),J=(I!==K);if(J){n.debug("URL value is already encoded, avoiding double encoding",K);return K}n.verbose("Encoding value using encodeURIComponent",K,H);return H},defaultData:function(){var H={};if(!c.isWindow(o)){if(n.is.input()){H.value=t.val()}else{if(n.is.form()){}else{H.text=t.text()}}}return H},event:function(){if(c.isWindow(o)||E.on=="now"){n.debug("API called without element, no events attached");return false}else{if(E.on=="auto"){if(t.is("input")){return(o.oninput!==d)?"input":(o.onpropertychange!==d)?"propertychange":"keyup"}else{if(t.is("form")){return"submit"}else{return"click"}}}else{return E.on}}},templatedURL:function(H){H=H||t.data(w.action)||E.action||false;s=t.data(w.url)||E.url||false;if(s){n.debug("Using specified url",s);return s}if(H){n.debug("Looking up url for action",H,E.api);if(E.api[H]===d&&!n.is.mocked()){n.error(B.missingAction,E.action,E.api);return}s=E.api[H]}else{if(n.is.form()){s=t.attr("action")||z.attr("action")||false;n.debug("No url or action specified, defaulting to form action",s)}}return s}},abort:function(){var H=n.get.xhr();if(H&&H.state()!=="resolved"){n.debug("Cancelling API request");H.abort()}},reset:function(){n.remove.error();n.remove.loading()},setting:function(H,I){n.debug("Changing setting",H,I);if(c.isPlainObject(H)){c.extend(true,E,H)}else{if(I!==d){if(c.isPlainObject(E[H])){c.extend(true,E[H],I)}else{E[H]=I}}else{return E[H]}}},internal:function(H,I){if(c.isPlainObject(H)){c.extend(true,n,H)}else{if(I!==d){n[H]=I}else{return n[H]}}},debug:function(){if(!E.silent&&E.debug){if(E.performance){n.performance.log(arguments)}else{n.debug=Function.prototype.bind.call(console.info,console,E.name+":");n.debug.apply(console,arguments)}}},verbose:function(){if(!E.silent&&E.verbose&&E.debug){if(E.performance){n.performance.log(arguments)}else{n.verbose=Function.prototype.bind.call(console.info,console,E.name+":");n.verbose.apply(console,arguments)}}},error:function(){if(!E.silent){n.error=Function.prototype.bind.call(console.error,console,E.name+":");n.error.apply(console,arguments)}},performance:{log:function(J){var I,K,H;if(E.performance){I=new Date().getTime();H=f||I;K=I-H;f=I;j.push({Name:J[0],Arguments:[].slice.call(J,1)||"","Execution Time":K})}clearTimeout(n.performance.timer);n.performance.timer=setTimeout(n.performance.display,500)},display:function(){var I=E.name+":",H=0;f=false;clearTimeout(n.performance.timer);c.each(j,function(J,K){H+=K["Execution Time"]});I+=" "+H+"ms";if(h){I+=" '"+h+"'"}if((console.group!==d||console.table!==d)&&j.length>0){console.groupCollapsed(I);if(console.table){console.table(j)}else{c.each(j,function(J,K){console.log(K.Name+": "+K["Execution Time"]+"ms")})}console.groupEnd()}j=[]}},invoke:function(M,I,K){var J=F,N,L,H;I=I||l;K=o||K;if(typeof M=="string"&&J!==d){M=M.split(/[\. ]/);N=M.length-1;c.each(M,function(Q,P){var O=(Q!=N)?P+M[Q+1].charAt(0).toUpperCase()+M[Q+1].slice(1):M;if(c.isPlainObject(J[O])&&(Q!=N)){J=J[O]}else{if(J[O]!==d){L=J[O];return false}else{if(c.isPlainObject(J[P])&&(Q!=N)){J=J[P]}else{if(J[P]!==d){L=J[P];return false}else{n.error(B.method,M);return false}}}}})}if(c.isFunction(L)){H=L.apply(K,I)}else{if(L!==d){H=L}}if(c.isArray(g)){g.push(H)}else{if(g!==d){g=[g,H]}else{if(H!==d){g=H}}}return L}};if(e){if(F===d){n.initialize()}n.invoke(i)}else{if(F!==d){F.invoke("destroy")}n.initialize()}});return(g!==d)?g:this};c.api.settings={name:"API",namespace:"api",debug:false,verbose:false,performance:true,api:{},cache:true,interruptRequests:true,on:"auto",stateContext:false,loadingDuration:0,hideError:"auto",errorDuration:2000,encodeParameters:true,action:false,url:false,base:"",urlData:{},defaultData:true,serializeForm:false,throttle:0,throttleFirstRequest:true,method:"get",data:{},dataType:"json",mockResponse:false,mockResponseAsync:false,response:false,responseAsync:false,beforeSend:function(e){return e},beforeXHR:function(e){},onRequest:function(f,e){},onResponse:false,onSuccess:function(e,f){},onComplete:function(e,f){},onFailure:function(e,f){},onError:function(e,f){},onAbort:function(e,f){},successTest:false,error:{beforeSend:"The before send function has aborted the request",error:"There was an error with your request",exitConditions:"API Request Aborted. Exit conditions met",JSONParse:"JSON could not be parsed during error handling",legacyParameters:"You are using legacy API success callback names",method:"The method you called is not defined",missingAction:"API action used but no url was defined",missingSerialize:"jquery-serialize-object is required to add form data to an existing data object",missingURL:"No URL specified for api event",noReturnedValue:"The beforeSend callback must return a settings object, beforeSend ignored.",noStorage:"Caching responses locally requires session storage",parseError:"There was an error parsing your request",requiredParameter:"Missing a required URL parameter: ",statusMessage:"Server gave an error: ",timeout:"Your request timed out"},regExp:{required:/\{\$*[A-z0-9]+\}/g,optional:/\{\/\$*[A-z0-9]+\}/g},className:{loading:"loading",error:"error"},selector:{disabled:".disabled",form:"form"},metadata:{action:"action",url:"url"}}})(jQuery,window,document);