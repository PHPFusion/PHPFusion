/*!
 * # Semantic UI 2.0.0 - Video
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2014 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(c,b,a,d){c.fn.video=function(n){var l=c(this),i=l.selector||"",f=new Date().getTime(),k=[],j=arguments[0],e=(typeof j=="string"),m=[].slice.call(arguments,1),h=b.requestAnimationFrame||b.mozRequestAnimationFrame||b.webkitRequestAnimationFrame||b.msRequestAnimationFrame||function(o){setTimeout(o,0)},g;l.each(function(){var r=(c.isPlainObject(n))?c.extend(true,{},c.fn.video.settings,n):c.extend({},c.fn.video.settings),t=r.selector,y=r.className,z=r.error,B=r.metadata,s=r.namespace,C=r.templates,E="."+s,v="module-"+s,q=c(b),A=c(this),x=A.find(t.placeholder),p=A.find(t.playButton),w=A.find(t.embed),u=this,D=A.data(v),o;o={initialize:function(){o.debug("Initializing video");o.create();A.on("click"+E,t.placeholder,o.play).on("click"+E,t.playButton,o.play);o.instantiate()},instantiate:function(){o.verbose("Storing instance of module",o);D=o;A.data(v,o)},create:function(){var G=A.data(B.image),F=C.video(G);A.html(F);o.refresh();if(!G){o.play()}o.debug("Creating html for video element",F)},destroy:function(){o.verbose("Destroying previous instance of video");o.reset();A.removeData(v).off(E)},refresh:function(){o.verbose("Refreshing selector cache");x=A.find(t.placeholder);p=A.find(t.playButton);w=A.find(t.embed)},change:function(G,H,F){o.debug("Changing video to ",G,H,F);A.data(B.source,G).data(B.id,H).data(B.url,F);r.onChange()},reset:function(){o.debug("Clearing video embed and showing placeholder");A.removeClass(y.active);w.html(" ");x.show();r.onReset()},play:function(){o.debug("Playing video");var G=A.data(B.source)||false,F=A.data(B.url)||false,H=A.data(B.id)||false;w.html(o.generate.html(G,H,F));A.addClass(y.active);r.onPlay()},get:{source:function(F){if(typeof F!=="string"){return false}if(F.search("youtube.com")!==-1){return"youtube"}else{if(F.search("vimeo.com")!==-1){return"vimeo"}}return false},id:function(F){if(F.match(r.regExp.youtube)){return F.match(r.regExp.youtube)[1]}else{if(F.match(r.regExp.vimeo)){return F.match(r.regExp.vimeo)[2]}}return false}},generate:{html:function(H,I,F){o.debug("Generating embed html");var G;H=H||r.source;I=I||r.id;if((H&&I)||F){if(!H||!I){H=o.get.source(F);I=o.get.id(F)}if(H=="vimeo"){G='<iframe src="//player.vimeo.com/video/'+I+"?="+o.generate.url(H)+'" width="100%" height="100%" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'}else{if(H=="youtube"){G='<iframe src="//www.youtube.com/embed/'+I+"?="+o.generate.url(H)+'" width="100%" height="100%" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'}}}else{o.error(z.noVideo)}return G},url:function(J){var G=(r.api)?1:0,I=(r.autoplay==="auto")?(A.data("image")!==d):r.autoplay,L=(r.hd)?1:0,H=(r.showUI)?1:0,K=!(r.showUI)?1:0,F="";if(J=="vimeo"){F="api="+G+"&amp;title="+H+"&amp;byline="+H+"&amp;portrait="+H+"&amp;autoplay="+I;if(r.color){F+="&amp;color="+r.color}}if(J=="ustream"){F="autoplay="+I;if(r.color){F+="&amp;color="+r.color}}else{if(J=="youtube"){F="enablejsapi="+G+"&amp;autoplay="+I+"&amp;autohide="+K+"&amp;hq="+L+"&amp;modestbranding=1";if(r.color){F+="&amp;color="+r.color}}}return F}},setting:function(F,G){o.debug("Changing setting",F,G);if(c.isPlainObject(F)){c.extend(true,r,F)}else{if(G!==d){r[F]=G}else{return r[F]}}},internal:function(F,G){if(c.isPlainObject(F)){c.extend(true,o,F)}else{if(G!==d){o[F]=G}else{return o[F]}}},debug:function(){if(r.debug){if(r.performance){o.performance.log(arguments)}else{o.debug=Function.prototype.bind.call(console.info,console,r.name+":");o.debug.apply(console,arguments)}}},verbose:function(){if(r.verbose&&r.debug){if(r.performance){o.performance.log(arguments)}else{o.verbose=Function.prototype.bind.call(console.info,console,r.name+":");o.verbose.apply(console,arguments)}}},error:function(){o.error=Function.prototype.bind.call(console.error,console,r.name+":");o.error.apply(console,arguments)},performance:{log:function(H){var G,I,F;if(r.performance){G=new Date().getTime();F=f||G;I=G-F;f=G;k.push({Name:H[0],Arguments:[].slice.call(H,1)||"",Element:u,"Execution Time":I})}clearTimeout(o.performance.timer);o.performance.timer=setTimeout(o.performance.display,500)},display:function(){var G=r.name+":",F=0;f=false;clearTimeout(o.performance.timer);c.each(k,function(H,I){F+=I["Execution Time"]});G+=" "+F+"ms";if(i){G+=" '"+i+"'"}if(l.length>1){G+=" ("+l.length+")"}if((console.group!==d||console.table!==d)&&k.length>0){console.groupCollapsed(G);if(console.table){console.table(k)}else{c.each(k,function(H,I){console.log(I.Name+": "+I["Execution Time"]+"ms")})}console.groupEnd()}k=[]}},invoke:function(K,G,I){var H=D,L,J,F;G=G||m;I=u||I;if(typeof K=="string"&&H!==d){K=K.split(/[\. ]/);L=K.length-1;c.each(K,function(O,N){var M=(O!=L)?N+K[O+1].charAt(0).toUpperCase()+K[O+1].slice(1):K;if(c.isPlainObject(H[M])&&(O!=L)){H=H[M]}else{if(H[M]!==d){J=H[M];return false}else{if(c.isPlainObject(H[N])&&(O!=L)){H=H[N]}else{if(H[N]!==d){J=H[N];return false}else{o.error(z.method,K);return false}}}}})}if(c.isFunction(J)){F=J.apply(I,G)}else{if(J!==d){F=J}}if(c.isArray(g)){g.push(F)}else{if(g!==d){g=[g,F]}else{if(F!==d){g=F}}}return J}};if(e){if(D===d){o.initialize()}o.invoke(j)}else{if(D!==d){D.invoke("destroy")}o.initialize()}});return(g!==d)?g:this};c.fn.video.settings={name:"Video",namespace:"video",debug:false,verbose:false,performance:true,metadata:{id:"id",image:"image",source:"source",url:"url"},source:false,url:false,id:false,aspectRatio:(16/9),onPlay:function(){},onReset:function(){},onChange:function(){},onPause:function(){},onStop:function(){},width:"auto",height:"auto",autoplay:"auto",color:"#442359",hd:true,showUI:false,api:true,regExp:{youtube:/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,vimeo:/http:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/},error:{noVideo:"No video specified",method:"The method you called is not defined"},className:{active:"active"},selector:{embed:".embed",placeholder:".placeholder",playButton:".play"}};c.fn.video.settings.templates={video:function(f){var e="";if(f){e+='<i class="video play icon"></i><img class="placeholder" src="'+f+'">'}e+='<div class="embed"></div>';return e}}})(jQuery,window,document);