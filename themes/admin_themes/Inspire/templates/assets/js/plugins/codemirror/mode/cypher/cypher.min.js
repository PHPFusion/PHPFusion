(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){var a=function(c){return new RegExp("^(?:"+c.join("|")+")$","i")};b.defineMode("cypher",function(d){var e=function(p){var m=p.next(),o=null;if(m==='"'||m==="'"){p.match(/.+?["']/);return"string"}if(/[{}\(\),\.;\[\]]/.test(m)){o=m;return"node"}else{if(m==="/"&&p.eat("/")){p.skipToEnd();return"comment"}else{if(f.test(m)){p.eatWhile(f);return null}else{p.eatWhile(/[_\w\d]/);if(p.eat(":")){p.eatWhile(/[\w\d_\-]/);return"atom"}var n=p.current();if(c.test(n)){return"builtin"}if(j.test(n)){return"def"}if(g.test(n)){return"keyword"}return"variable"}}}};var i=function(o,n,m){return o.context={prev:o.context,indent:o.indent,col:m,type:n}};var k=function(m){m.indent=m.context.indent;return m.context=m.context.prev};var h=d.indentUnit;var l;var c=a(["abs","acos","allShortestPaths","asin","atan","atan2","avg","ceil","coalesce","collect","cos","cot","count","degrees","e","endnode","exp","extract","filter","floor","haversin","head","id","labels","last","left","length","log","log10","lower","ltrim","max","min","node","nodes","percentileCont","percentileDisc","pi","radians","rand","range","reduce","rel","relationship","relationships","replace","right","round","rtrim","shortestPath","sign","sin","split","sqrt","startnode","stdev","stdevp","str","substring","sum","tail","tan","timestamp","toFloat","toInt","trim","type","upper"]);var j=a(["all","and","any","has","in","none","not","or","single","xor"]);var g=a(["as","asc","ascending","assert","by","case","commit","constraint","create","csv","cypher","delete","desc","descending","distinct","drop","else","end","false","fieldterminator","foreach","from","headers","in","index","is","limit","load","match","merge","null","on","optional","order","periodic","remove","return","scan","set","skip","start","then","true","union","unique","unwind","using","when","where","with"]);var f=/[*+\-<>=&|~%^]/;return{startState:function(){return{tokenize:e,context:null,indent:0,col:0}},token:function(o,n){if(o.sol()){if(n.context&&(n.context.align==null)){n.context.align=false}n.indent=o.indentation()}if(o.eatSpace()){return null}var m=n.tokenize(o,n);if(m!=="comment"&&n.context&&(n.context.align==null)&&n.context.type!=="pattern"){n.context.align=true}if(l==="("){i(n,")",o.column())}else{if(l==="["){i(n,"]",o.column())}else{if(l==="{"){i(n,"}",o.column())}else{if(/[\]\}\)]/.test(l)){while(n.context&&n.context.type==="pattern"){k(n)}if(n.context&&l===n.context.type){k(n)}}else{if(l==="."&&n.context&&n.context.type==="pattern"){k(n)}else{if(/atom|string|variable/.test(m)&&n.context){if(/[\}\]]/.test(n.context.type)){i(n,"pattern",o.column())}else{if(n.context.type==="pattern"&&!n.context.align){n.context.align=true;n.context.col=o.column()}}}}}}}}return m},indent:function(q,m){var p=m&&m.charAt(0);var o=q.context;if(/[\]\}]/.test(p)){while(o&&o.type==="pattern"){o=o.prev}}var n=o&&p===o.type;if(!o){return 0}if(o.type==="keywords"){return b.commands.newlineAndIndent}if(o.align){return o.col+(n?0:1)}return o.indent+(n?0:h)}}});b.modeExtensions.cypher={autoFormatLineBreaks:function(f){var d,c,e;var c=f.split("\n");var e=/\s+\b(return|where|order by|match|with|skip|limit|create|delete|set)\b\s/g;for(var d=0;d<c.length;d++){c[d]=c[d].replace(e," \n$1 ").trim()}return c.join("\n")}};b.defineMIME("application/x-cypher-query","cypher")});