(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("../htmlmixed/htmlmixed"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../htmlmixed/htmlmixed"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("htmlembedded",function(d,f){var b=f.scriptStartRegex||/^<%/i,c=f.scriptEndRegex||/^%>/i;var i,g;function h(k,j){if(k.match(b,false)){j.token=e;return i.token(k,j.scriptState)}else{return g.token(k,j.htmlState)}}function e(k,j){if(k.match(c,false)){j.token=h;return g.token(k,j.htmlState)}else{return i.token(k,j.scriptState)}}return{startState:function(){i=i||a.getMode(d,f.scriptingModeSpec);g=g||a.getMode(d,"htmlmixed");return{token:f.startOpen?e:h,htmlState:a.startState(g),scriptState:a.startState(i)}},token:function(k,j){return j.token(k,j)},indent:function(k,j){if(k.token==h){return g.indent(k.htmlState,j)}else{if(i.indent){return i.indent(k.scriptState,j)}}},copyState:function(j){return{token:j.token,htmlState:a.copyState(g,j.htmlState),scriptState:a.copyState(i,j.scriptState)}},innerMode:function(j){if(j.token==e){return{state:j.scriptState,mode:i}}else{return{state:j.htmlState,mode:g}}}}},"htmlmixed");a.defineMIME("application/x-ejs",{name:"htmlembedded",scriptingModeSpec:"javascript"});a.defineMIME("application/x-aspx",{name:"htmlembedded",scriptingModeSpec:"text/x-csharp"});a.defineMIME("application/x-jsp",{name:"htmlembedded",scriptingModeSpec:"text/x-java"});a.defineMIME("application/x-erb",{name:"htmlembedded",scriptingModeSpec:"ruby"})});