(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("vb",function(m,z){var c="error";function q(G){return new RegExp("^(("+G.join(")|(")+"))\\b","i")}var p=new RegExp("^[\\+\\-\\*/%&\\\\|\\^~<>!]");var t=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]");var b=new RegExp("^((==)|(<>)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))");var j=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))");var C=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))");var i=new RegExp("^[_A-Za-z][_A-Za-z0-9]*");var v=["class","module","sub","enum","select","while","if","function","get","set","property","try"];var s=["else","elseif","case","catch"];var F=["next","loop"];var e=q(["and","or","not","xor","in"]);var y=["as","dim","break","continue","optional","then","until","goto","byval","byref","new","handles","property","return","const","private","protected","friend","public","shared","static","true","false"];var w=["integer","string","double","decimal","boolean","short","char","float","single"];var k=q(y);var o=q(w);var l='"';var u=q(v);var B=q(s);var h=q(F);var r=q(["end"]);var d=q(["do"]);var A=null;function n(G,H){H.currentIndent++}function f(G,H){H.currentIndent--}function E(K,J){if(K.eatSpace()){return null}var I=K.peek();if(I==="'"){K.skipToEnd();return"comment"}if(K.match(/^((&H)|(&O))?[0-9\.a-f]/i,false)){var H=false;if(K.match(/^\d*\.\d+F?/i)){H=true}else{if(K.match(/^\d+\.\d*F?/)){H=true}else{if(K.match(/^\.\d+F?/)){H=true}}}if(H){K.eat(/J/i);return"number"}var G=false;if(K.match(/^&H[0-9a-f]+/i)){G=true}else{if(K.match(/^&O[0-7]+/i)){G=true}else{if(K.match(/^[1-9]\d*F?/)){K.eat(/J/i);G=true}else{if(K.match(/^0(?![\dx])/i)){G=true}}}}if(G){K.eat(/L/i);return"number"}}if(K.match(l)){J.tokenize=x(K.current());return J.tokenize(K,J)}if(K.match(C)||K.match(j)){return null}if(K.match(b)||K.match(p)||K.match(e)){return"operator"}if(K.match(t)){return null}if(K.match(d)){n(K,J);J.doInCurrentLine=true;return"keyword"}if(K.match(u)){if(!J.doInCurrentLine){n(K,J)}else{J.doInCurrentLine=false}return"keyword"}if(K.match(B)){return"keyword"}if(K.match(r)){f(K,J);f(K,J);return"keyword"}if(K.match(h)){f(K,J);return"keyword"}if(K.match(o)){return"keyword"}if(K.match(k)){return"keyword"}if(K.match(i)){return"variable"}K.next();return c}function x(G){var I=G.length==1;var H="string";return function(K,J){while(!K.eol()){K.eatWhile(/[^'"]/);if(K.match(G)){J.tokenize=E;return H}else{K.eat(/['"]/)}}if(I){if(z.singleLineStringErrors){return c}else{J.tokenize=E}}return H}}function D(K,I){var H=I.tokenize(K,I);var J=K.current();if(J==="."){H=I.tokenize(K,I);J=K.current();if(H==="variable"){return"variable"}else{return c}}var G="[({".indexOf(J);if(G!==-1){n(K,I)}if(A==="dedent"){if(f(K,I)){return c}}G="])}".indexOf(J);if(G!==-1){if(f(K,I)){return c}}return H}var g={electricChars:"dDpPtTfFeE ",startState:function(){return{tokenize:E,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:false}},token:function(I,H){if(I.sol()){H.currentIndent+=H.nextLineIndent;H.nextLineIndent=0;H.doInCurrentLine=0}var G=D(I,H);H.lastToken={style:G,content:I.current()};return G},indent:function(I,G){var H=G.replace(/^\s+|\s+$/g,"");if(H.match(h)||H.match(r)||H.match(B)){return m.indentUnit*(I.currentIndent-1)}if(I.currentIndent<0){return 0}return I.currentIndent*m.indentUnit}};return g});a.defineMIME("text/x-vb","vb")});