(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("smalltalk",function(d){var e=/[+\-\/\\*~<>=@%|&?!.,:;^]/;var h=/true|false|nil|self|super|thisContext/;var j=function(n,m){this.next=n;this.parent=m};var c=function(m,n,o){this.name=m;this.context=n;this.eos=o};var k=function(){this.context=new j(g,null);this.expectVariable=true;this.indentation=0;this.userIndentationDelta=0};k.prototype.userIndent=function(m){this.userIndentationDelta=m>0?(m/d.indentUnit-this.indentation):0};var g=function(q,o,p){var n=new c(null,o,false);var m=q.next();if(m==='"'){n=b(q,new j(b,o))}else{if(m==="'"){n=l(q,new j(l,o))}else{if(m==="#"){if(q.peek()==="'"){q.next();n=i(q,new j(i,o))}else{if(q.eatWhile(/[^\s.{}\[\]()]/)){n.name="string-2"}else{n.name="meta"}}}else{if(m==="$"){if(q.next()==="<"){q.eatWhile(/[^\s>]/);q.next()}n.name="string-2"}else{if(m==="|"&&p.expectVariable){n.context=new j(f,o)}else{if(/[\[\]{}()]/.test(m)){n.name="bracket";n.eos=/[\[{(]/.test(m);if(m==="["){p.indentation++}else{if(m==="]"){p.indentation=Math.max(0,p.indentation-1)}}}else{if(e.test(m)){q.eatWhile(e);n.name="operator";n.eos=m!==";"}else{if(/\d/.test(m)){q.eatWhile(/[\w\d]/);n.name="number"}else{if(/[\w_]/.test(m)){q.eatWhile(/[\w\d_]/);n.name=p.expectVariable?(h.test(q.current())?"keyword":"variable"):null}else{n.eos=p.expectVariable}}}}}}}}}return n};var b=function(n,m){n.eatWhile(/[^"]/);return new c("comment",n.eat('"')?m.parent:m,true)};var l=function(n,m){n.eatWhile(/[^']/);return new c("string",n.eat("'")?m.parent:m,false)};var i=function(n,m){n.eatWhile(/[^']/);return new c("string-2",n.eat("'")?m.parent:m,false)};var f=function(p,o){var n=new c(null,o,false);var m=p.next();if(m==="|"){n.context=o.parent;n.eos=true}else{p.eatWhile(/[^|]/);n.name="variable"}return n};return{startState:function(){return new k},token:function(o,n){n.userIndent(o.indentation());if(o.eatSpace()){return null}var m=n.context.next(o,n.context,n);n.context=m.context;n.expectVariable=m.eos;return m.name},blankLine:function(m){m.userIndent(0)},indent:function(o,m){var n=o.context.next===g&&m&&m.charAt(0)==="]"?-1:o.userIndentationDelta;return(o.indentation+n)*d.indentUnit},electricChars:"]"}});a.defineMIME("text/x-stsrc",{name:"smalltalk"})});