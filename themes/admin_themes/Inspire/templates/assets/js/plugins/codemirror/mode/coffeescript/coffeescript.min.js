(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("coffeescript",function(l){var b="error";function p(x){return new RegExp("^(("+x.join(")|(")+"))\\b")}var r=/^(?:->|=>|\+[+=]?|-[\-=]?|\*[\*=]?|\/[\/=]?|[=!]=|<[><]?=?|>>?=?|%=?|&=?|\|=?|\^=?|\~|!|\?|(or|and|\|\||&&|\?)=)/;var g=/^(?:[()\[\]{},:`=;]|\.\.?\.?)/;var h=/^[_A-Za-z$][_A-Za-z$0-9]*/;var j=/^(@|this\.)[_A-Za-z$][_A-Za-z$0-9]*/;var d=p(["and","or","not","is","isnt","in","instanceof","typeof"]);var c=["for","while","loop","if","unless","else","switch","try","catch","finally","class"];var s=["break","by","continue","debugger","delete","do","in","of","new","return","then","this","@","throw","when","until","extends"];var k=p(c.concat(s));c=p(c);var m=/^('{3}|\"{3}|['\"])/;var i=/^(\/{3}|\/)/;var n=["Infinity","NaN","undefined","null","true","false","on","off","yes","no"];var v=p(n);function w(D,C){if(D.sol()){if(C.scope.align===null){C.scope.align=false}var y=C.scope.offset;if(D.eatSpace()){var A=D.indentation();if(A>y&&C.scope.type=="coffee"){return"indent"}else{if(A<y){return"dedent"}}return null}else{if(y>0){e(D,C)}}}if(D.eatSpace()){return null}var B=D.peek();if(D.match("####")){D.skipToEnd();return"comment"}if(D.match("###")){C.tokenize=q;return C.tokenize(D,C)}if(B==="#"){D.skipToEnd();return"comment"}if(D.match(/^-?[0-9\.]/,false)){var z=false;if(D.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)){z=true}if(D.match(/^-?\d+\.\d*/)){z=true}if(D.match(/^-?\.\d+/)){z=true}if(z){if(D.peek()=="."){D.backUp(1)}return"number"}var x=false;if(D.match(/^-?0x[0-9a-f]+/i)){x=true}if(D.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)){x=true}if(D.match(/^-?0(?![\dx])/i)){x=true}if(x){return"number"}}if(D.match(m)){C.tokenize=t(D.current(),false,"string");return C.tokenize(D,C)}if(D.match(i)){if(D.current()!="/"||D.match(/^.*\//,false)){C.tokenize=t(D.current(),true,"string-2");return C.tokenize(D,C)}else{D.backUp(1)}}if(D.match(r)||D.match(d)){return"operator"}if(D.match(g)){return"punctuation"}if(D.match(v)){return"atom"}if(D.match(k)){return"keyword"}if(D.match(h)){return"variable"}if(D.match(j)){return"property"}D.next();return b}function t(x,y,z){return function(B,A){while(!B.eol()){B.eatWhile(/[^'"\/\\]/);if(B.eat("\\")){B.next();if(y&&B.eol()){return z}}else{if(B.match(x)){A.tokenize=w;return z}else{B.eat(/['"\/]/)}}}if(y){if(l.mode.singleLineStringErrors){z=b}else{A.tokenize=w}}return z}}function q(y,x){while(!y.eol()){y.eatWhile(/[^#]/);if(y.match("###")){x.tokenize=w;break}y.eatWhile("#")}return"comment"}function o(C,A,z){z=z||"coffee";var B=0,D=false,x=null;for(var y=A.scope;y;y=y.prev){if(y.type==="coffee"||y.type=="}"){B=y.offset+l.indentUnit;break}}if(z!=="coffee"){D=null;x=C.column()+C.current().length}else{if(A.scope.align){A.scope.align=false}}A.scope={offset:B,type:z,prev:A.scope,align:D,alignOffset:x}}function e(B,A){if(!A.scope.prev){return}if(A.scope.type==="coffee"){var y=B.indentation();var x=false;for(var z=A.scope;z;z=z.prev){if(y===z.offset){x=true;break}}if(!x){return true}while(A.scope.prev&&A.scope.offset!==y){A.scope=A.scope.prev}return false}else{A.scope=A.scope.prev;return false}}function u(B,z){var y=z.tokenize(B,z);var A=B.current();if(A==="."){y=z.tokenize(B,z);A=B.current();if(/^\.[\w$]+$/.test(A)){return"variable"}else{return b}}if(A==="return"){z.dedent=true}if(((A==="->"||A==="=>")&&!z.lambda&&!B.peek())||y==="indent"){o(B,z)}var x="[({".indexOf(A);if(x!==-1){o(B,z,"])}".slice(x,x+1))}if(c.exec(A)){o(B,z)}if(A=="then"){e(B,z)}if(y==="dedent"){if(e(B,z)){return b}}x="])}".indexOf(A);if(x!==-1){while(z.scope.type=="coffee"&&z.scope.prev){z.scope=z.scope.prev}if(z.scope.type==A){z.scope=z.scope.prev}}if(z.dedent&&B.eol()){if(z.scope.type=="coffee"&&z.scope.prev){z.scope=z.scope.prev}z.dedent=false}return y}var f={startState:function(x){return{tokenize:w,scope:{offset:x||0,type:"coffee",prev:null,align:false},lastToken:null,lambda:false,dedent:0}},token:function(A,z){var y=z.scope.align===null&&z.scope;if(y&&A.sol()){y.align=false}var x=u(A,z);if(y&&x&&x!="comment"){y.align=true}z.lastToken={style:x,content:A.current()};if(A.eol()&&A.lambda){z.lambda=false}return x},indent:function(y,A){if(y.tokenize!=w){return 0}var x=y.scope;var B=A&&"])}".indexOf(A.charAt(0))>-1;if(B){while(x.type=="coffee"&&x.prev){x=x.prev}}var z=B&&x.type===A.charAt(0);if(x.align){return x.alignOffset-(z?1:0)}else{return(z?x.prev:x).offset}},lineComment:"#",fold:"indent"};return f});a.defineMIME("text/x-coffeescript","coffeescript")});