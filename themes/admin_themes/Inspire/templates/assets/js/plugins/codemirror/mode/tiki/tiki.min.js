(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("tiki",function(v){function u(z,y,x){return function(B,A){while(!B.eol()){if(B.match(y)){A.tokenize=n;break}B.next()}if(x){A.tokenize=x}return z}}function m(x){return function(z,y){while(!z.eol()){z.next()}y.tokenize=n;return x}}function n(C,B){function y(E){B.tokenize=E;return E(C,B)}var A=C.sol();var z=C.next();switch(z){case"{":C.eat("/");C.eatSpace();var x="";var D;while((D=C.eat(/[^\s\u00a0=\"\'\/?(}]/))){x+=D}B.tokenize=w;return"tag";break;case"_":if(C.eat("_")){return y(u("strong","__",n))}break;case"'":if(C.eat("'")){return y(u("em","''",n))}break;case"(":if(C.eat("(")){return y(u("variable-2","))",n))}break;case"[":return y(u("variable-3","]",n));break;case"|":if(C.eat("|")){return y(u("comment","||"))}break;case"-":if(C.eat("=")){return y(u("header string","=-",n))}else{if(C.eat("-")){return y(u("error tw-deleted","--",n))}}break;case"=":if(C.match("==")){return y(u("tw-underline","===",n))}break;case":":if(C.eat(":")){return y(u("comment","::"))}break;case"^":return y(u("tw-box","^"));break;case"~":if(C.match("np~")){return y(u("meta","~/np~"))}break}if(A){switch(z){case"!":if(C.match("!!!!!")){return y(m("header string"))}else{if(C.match("!!!!")){return y(m("header string"))}else{if(C.match("!!!")){return y(m("header string"))}else{if(C.match("!!")){return y(m("header string"))}else{return y(m("header string"))}}}}break;case"*":case"#":case"+":return y(m("tw-listitem bracket"));break}}return null}var o=v.indentUnit;var b,g;function w(A,z){var y=A.next();var x=A.peek();if(y=="}"){z.tokenize=n;return"tag"}else{if(y=="("||y==")"){return"bracket"}else{if(y=="="){g="equals";if(x==">"){y=A.next();x=A.peek()}if(!/[\'\"]/.test(x)){z.tokenize=s()}return"operator"}else{if(/[\'\"]/.test(y)){z.tokenize=j(y);return z.tokenize(A,z)}else{A.eatWhile(/[^\s\u00a0=\"\'\/?]/);return"keyword"}}}}}function j(x){return function(z,y){while(!z.eol()){if(z.next()==x){y.tokenize=w;break}}return"string"}}function s(){return function(A,z){while(!A.eol()){var y=A.next();var x=A.peek();if(y==" "||y==","||/[ )}]/.test(x)){z.tokenize=w;break}}return"string"}}var k,h;function c(){for(var x=arguments.length-1;x>=0;x--){k.cc.push(arguments[x])}}function e(){c.apply(null,arguments);return true}function i(y,z){var x=k.context&&k.context.noIndent;k.context={prev:k.context,pluginName:y,indent:k.indented,startOfLine:z,noIndent:x}}function r(){if(k.context){k.context=k.context.prev}}function d(x){if(x=="openPlugin"){k.pluginName=b;return e(l,p(k.startOfLine))}else{if(x=="closePlugin"){var y=false;if(k.context){y=k.context.pluginName!=b;r()}else{y=true}if(y){h="error"}return e(f(y))}else{if(x=="string"){if(!k.context||k.context.name!="!cdata"){i("!cdata")}if(k.tokenize==n){r()}return e()}else{return e()}}}}function p(x){return function(y){if(y=="selfclosePlugin"||y=="endPlugin"){return e()}if(y=="endPlugin"){i(k.pluginName,x);return e()}return e()}}function f(x){return function(y){if(x){h="error"}if(y=="endPlugin"){return e()}return c()}}function l(x){if(x=="keyword"){h="attribute";return e(l)}if(x=="equals"){return e(t,l)}return c()}function t(x){if(x=="keyword"){h="string";return e()}if(x=="string"){return e(q)}return c()}function q(x){if(x=="string"){return e(q)}else{return c()}}return{startState:function(){return{tokenize:n,cc:[],indented:0,startOfLine:true,pluginName:null,context:null}},token:function(A,z){if(A.sol()){z.startOfLine=true;z.indented=A.indentation()}if(A.eatSpace()){return null}h=g=b=null;var y=z.tokenize(A,z);if((y||g)&&y!="comment"){k=z;while(true){var x=z.cc.pop()||d;if(x(g||y)){break}}}z.startOfLine=false;return h||y},indent:function(z,x){var y=z.context;if(y&&y.noIndent){return 0}if(y&&/^{\//.test(x)){y=y.prev}while(y&&!y.startOfLine){y=y.prev}if(y){return y.indent+o}else{return 0}},electricChars:"/"}});a.defineMIME("text/tiki","tiki")});