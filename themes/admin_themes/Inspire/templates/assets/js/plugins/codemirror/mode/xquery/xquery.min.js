(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("xquery",function(){var h=function(){function N(A){return{type:A,style:"keyword"}}var G=N("keyword a"),E=N("keyword b"),y=N("keyword c"),F=N("operator"),M={type:"atom",style:"atom"},x={type:"punctuation",style:null},O={type:"axis_specifier",style:"qualifier"};var D={"if":G,"switch":G,"while":G,"for":G,"else":E,then:E,"try":E,"finally":E,"catch":E,element:y,attribute:y,let:y,"implements":y,"import":y,module:y,namespace:y,"return":y,"super":y,"this":y,"throws":y,where:y,"private":y,",":x,"null":M,"fn:false()":M,"fn:true()":M};var I=["after","ancestor","ancestor-or-self","and","as","ascending","assert","attribute","before","by","case","cast","child","comment","declare","default","define","descendant","descendant-or-self","descending","document","document-node","element","else","eq","every","except","external","following","following-sibling","follows","for","function","if","import","in","instance","intersect","item","let","module","namespace","node","node","of","only","or","order","parent","precedes","preceding","preceding-sibling","processing-instruction","ref","return","returns","satisfies","schema","schema-element","self","some","sortby","stable","text","then","to","treat","typeswitch","union","variable","version","where","xquery","empty-sequence"];for(var K=0,H=I.length;K<H;K++){D[I[K]]=N(I[K])}var L=["xs:string","xs:float","xs:decimal","xs:double","xs:integer","xs:boolean","xs:date","xs:dateTime","xs:time","xs:duration","xs:dayTimeDuration","xs:time","xs:yearMonthDuration","numeric","xs:hexBinary","xs:base64Binary","xs:anyURI","xs:QName","xs:byte","xs:boolean","xs:anyURI","xf:yearMonthDuration"];for(var K=0,H=L.length;K<H;K++){D[L[K]]=M}var J=["eq","ne","lt","le","gt","ge",":=","=",">",">=","<","<=",".","|","?","and","or","div","idiv","mod","*","/","+","-"];for(var K=0,H=J.length;K<H;K++){D[J[K]]=F}var z=["self::","attribute::","child::","descendant::","descendant-or-self::","parent::","ancestor::","ancestor-or-self::","following::","preceding::","following-sibling::","preceding-sibling::"];for(var K=0,H=z.length;K<H;K++){D[z[K]]=O}return D}();var e,o;function v(z,y,x){e=z;o=x;return y}function m(z,y,x){y.tokenize=x;return x(z,y)}function w(E,z){var x=E.next(),G=false,H=p(E);if(x=="<"){if(E.match("!--",true)){return m(E,z,b)}if(E.match("![CDATA",false)){z.tokenize=g;return v("tag","tag")}if(E.match("?",false)){return m(E,z,d)}var A=E.eat("/");E.eatSpace();var B="",D;while((D=E.eat(/[^\s\u00a0=<>\"\'\/?]/))){B+=D}return m(E,z,s(B,A))}else{if(x=="{"){r(z,{type:"codeblock"});return v("",null)}else{if(x=="}"){i(z);return v("",null)}else{if(c(z)){if(x==">"){return v("tag","tag")}else{if(x=="/"&&E.eat(">")){i(z);return v("tag","tag")}else{return v("word","variable")}}}else{if(/\d/.test(x)){E.match(/^\d*(?:\.\d*)?(?:E[+\-]?\d+)?/);return v("number","atom")}else{if(x==="("&&E.eat(":")){r(z,{type:"comment"});return m(E,z,l)}else{if(!H&&(x==='"'||x==="'")){return m(E,z,f(x))}else{if(x==="$"){return m(E,z,n)}else{if(x===":"&&E.eat("=")){return v("operator","keyword")}else{if(x==="("){r(z,{type:"paren"});return v("",null)}else{if(x===")"){i(z);return v("",null)}else{if(x==="["){r(z,{type:"bracket"});return v("",null)}else{if(x==="]"){i(z);return v("",null)}else{var F=h.propertyIsEnumerable(x)&&h[x];if(H&&x==='"'){while(E.next()!=='"'){}}if(H&&x==="'"){while(E.next()!=="'"){}}if(!F){E.eatWhile(/[\w\$_-]/)}var C=E.eat(":");if(!E.eat(":")&&C){E.eatWhile(/[\w\$_-]/)}if(E.match(/^[ \t]*\(/,false)){G=true}var y=E.current();F=h.propertyIsEnumerable(y)&&h[y];if(G&&!F){F={type:"function_call",style:"variable def"}}if(u(z)){i(z);return v("word","variable",y)}if(y=="element"||y=="attribute"||F.type=="axis_specifier"){r(z,{type:"xmlconstructor"})}return F?v(F.type,F.style,y):v("word","variable",y)}}}}}}}}}}}}}}function l(C,A){var y=false,x=false,B=0,z;while(z=C.next()){if(z==")"&&y){if(B>0){B--}else{i(A);break}}else{if(z==":"&&x){B++}}y=(z==":");x=(z=="(")}return v("comment","comment")}function f(x,y){return function(B,A){var z;if(k(A)&&B.current()==x){i(A);if(y){A.tokenize=y}return v("string","string")}r(A,{type:"string",name:x,tokenize:f(x,y)});if(B.match("{",false)&&j(A)){A.tokenize=w;return v("string","string")}while(z=B.next()){if(z==x){i(A);if(y){A.tokenize=y}break}else{if(B.match("{",false)&&j(A)){A.tokenize=w;return v("string","string")}}}return v("string","string")}}function n(z,x){var y=/[\w\$_-]/;if(z.eat('"')){while(z.next()!=='"'){}z.eat(":")}else{z.eatWhile(y);if(!z.match(":=",false)){z.eat(":")}}z.eatWhile(y);x.tokenize=w;return v("variable","variable")}function s(x,y){return function(A,z){A.eatSpace();if(y&&A.eat(">")){i(z);z.tokenize=w;return v("tag","tag")}if(!A.eat("/")){r(z,{type:"tag",name:x,tokenize:w})}if(!A.eat(">")){z.tokenize=t;return v("tag","tag")}else{z.tokenize=w}return v("tag","tag")}}function t(z,y){var x=z.next();if(x=="/"&&z.eat(">")){if(j(y)){i(y)}if(c(y)){i(y)}return v("tag","tag")}if(x==">"){if(j(y)){i(y)}return v("tag","tag")}if(x=="="){return v("",null)}if(x=='"'||x=="'"){return m(z,y,f(x,t))}if(!j(y)){r(y,{type:"attribute",tokenize:t})}z.eat(/[a-zA-Z_:]/);z.eatWhile(/[-a-zA-Z0-9_:.]/);z.eatSpace();if(z.match(">",false)||z.match("/",false)){i(y);y.tokenize=w}return v("attribute","attribute")}function b(z,y){var x;while(x=z.next()){if(x=="-"&&z.match("->",true)){y.tokenize=w;return v("comment","comment")}}}function g(z,y){var x;while(x=z.next()){if(x=="]"&&z.match("]",true)){y.tokenize=w;return v("comment","comment")}}}function d(z,y){var x;while(x=z.next()){if(x=="?"&&z.match(">",true)){y.tokenize=w;return v("comment","comment meta")}}}function c(x){return q(x,"tag")}function j(x){return q(x,"attribute")}function u(x){return q(x,"xmlconstructor")}function k(x){return q(x,"string")}function p(x){if(x.current()==='"'){return x.match(/^[^\"]+\"\:/,false)}else{if(x.current()==="'"){return x.match(/^[^\"]+\'\:/,false)}else{return false}}}function q(y,x){return(y.stack.length&&y.stack[y.stack.length-1].type==x)}function r(x,y){x.stack.push(y)}function i(x){x.stack.pop();var y=x.stack.length&&x.stack[x.stack.length-1].tokenize;x.tokenize=y||w}return{startState:function(){return{tokenize:w,cc:[],stack:[]}},token:function(z,y){if(z.eatSpace()){return null}var x=y.tokenize(z,y);return x},blockCommentStart:"(:",blockCommentEnd:":)"}});a.defineMIME("application/xquery","xquery")});