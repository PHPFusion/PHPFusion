(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("stex",function(){function j(m,n){m.cmdState.push(n)}function h(m){if(m.cmdState.length>0){return m.cmdState[m.cmdState.length-1]}else{return null}}function l(n){var m=n.cmdState.pop();if(m){m.closeBracket()}}function b(p){var o=p.cmdState;for(var n=o.length-1;n>=0;n--){var m=o[n];if(m.name=="DEFAULT"){continue}return m}return{styleIdentifier:function(){return null}}}function c(o,n,m){return function(){this.name=o;this.bracketNo=0;this.style=n;this.styles=m;this.argument=null;this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null};this.openBracket=function(){this.bracketNo++;return"bracket"};this.closeBracket=function(){}}}var d={};d.importmodule=c("importmodule","tag",["string","builtin"]);d.documentclass=c("documentclass","tag",["","atom"]);d.usepackage=c("usepackage","tag",["atom"]);d.begin=c("begin","tag",["atom"]);d.end=c("end","tag",["atom"]);d.DEFAULT=function(){this.name="DEFAULT";this.style="tag";this.styleIdentifier=this.openBracket=this.closeBracket=function(){}};function e(n,m){n.f=m}function f(q,p){var m;if(q.match(/^\\[a-zA-Z@]+/)){var n=q.current().slice(1);m=d[n]||d.DEFAULT;m=new m();j(p,m);e(p,g);return m.style}if(q.match(/^\\[$&%#{}_]/)){return"tag"}if(q.match(/^\\[,;!\/\\]/)){return"tag"}if(q.match("\\[")){e(p,function(s,r){return i(s,r,"\\]")});return"keyword"}if(q.match("$$")){e(p,function(s,r){return i(s,r,"$$")});return"keyword"}if(q.match("$")){e(p,function(s,r){return i(s,r,"$")});return"keyword"}var o=q.next();if(o=="%"){if(!q.eol()){e(p,k)}return"comment"}else{if(o=="}"||o=="]"){m=h(p);if(m){m.closeBracket(o);e(p,g)}else{return"error"}return"bracket"}else{if(o=="{"||o=="["){m=d.DEFAULT;m=new m();j(p,m);return"bracket"}else{if(/\d/.test(o)){q.eatWhile(/[\w.%]/);return"atom"}else{q.eatWhile(/[\w\-_]/);m=b(p);if(m.name=="begin"){m.argument=q.current()}return m.styleIdentifier()}}}}}function k(n,m){n.skipToEnd();e(m,f);return"comment"}function i(o,n,p){if(o.eatSpace()){return null}if(o.match(p)){e(n,f);return"keyword"}if(o.match(/^\\[a-zA-Z@]+/)){return"tag"}if(o.match(/^[a-zA-Z]+/)){return"variable-2"}if(o.match(/^\\[$&%#{}_]/)){return"tag"}if(o.match(/^\\[,;!\/]/)){return"tag"}if(o.match(/^[\^_&]/)){return"tag"}if(o.match(/^[+\-<>|=,\/@!*:;'"`~#?]/)){return null}if(o.match(/^(\d+\.\d*|\d*\.\d+|\d+)/)){return"number"}var m=o.next();if(m=="{"||m=="}"||m=="["||m=="]"||m=="("||m==")"){return"bracket"}if(m=="%"){if(!o.eol()){o.skipToEnd()}return"comment"}return"error"}function g(p,o){var n=p.peek(),m;if(n=="{"||n=="["){m=h(o);m.openBracket(n);p.eat(n);e(o,f);return"bracket"}if(/[ \t\r]/.test(n)){p.eat(n);return null}e(o,f);l(o);return f(p,o)}return{startState:function(){return{cmdState:[],f:f}},copyState:function(m){return{cmdState:m.cmdState.slice(),f:m.f}},token:function(n,m){return m.f(n,m)},lineComment:"%"}});a.defineMIME("text/x-stex","stex");a.defineMIME("text/x-latex","stex")});